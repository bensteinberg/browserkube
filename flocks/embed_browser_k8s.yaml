name: embed-browser

volumes:
  tmpdir: '/tmp/.X11-unix'
  webarchive: '/webarchive' 

containers:
  - name: pywb
    image: gcr.io/nice-root-261802/embedsarchive_pywb
    environment:
      INIT_COLLECTION: capture

  - name: browser
    image: oldwebtoday/base-browser
    image_label: wr.name
    set_user_params: true

    environment:
      PROXY_HOST: 'localhost'
      PROXY_PORT: '8080'
      PROXY_CA_URL: 'http://wsgiprox/download/pem'
      PROXY_CA_FILE: '/tmp/proxy-ca.pem'

  - name: embedserver
    image: gcr.io/nice-root-261802/embedsarchive_driver
    external_network: '${BROWSER_NET}'
    environment:
      BROWSER_HOST: localhost
      PROXY_HOST: localhost
      EMBED_HOST: embedserver
      EMBED_PORT: 80

    ports:
      driver-api: 80

